---
description: Best practices for mocking in tests
globs:
  - "tests/**/*.{ts,tsx}"
---

# Testing Mock Patterns

## Component Mock Props

**Problem**: Mocks ignore props that components expect, making mocks inaccurate.

**Solution**: Accept all props in mocks, even if unused. Use `eslint-disable` for intentionally unused parameters.

```tsx
// ❌ Bad - ignores props component expects
vi.mock("../../app/components/Chat", () => ({
  Chat: () => <div>Chat Component</div>,
}));

// ✅ Good - accepts props, marks unused as intentional
vi.mock("../../app/components/Chat", () => ({
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  Chat: ({ inputRef }: { inputRef?: (el: HTMLInputElement | null) => void }) => (
    <div>Chat Component</div>
  ),
}));
```

## Complete Module Mocks

**Problem**: Mocks don't export all symbols that components import, making mocks incomplete.

**Solution**: Export all symbols that components import from mocked modules.

```tsx
// ❌ Bad - missing DefaultChatTransport export
vi.mock("@ai-sdk/react", () => ({
  useChat: () => ({ messages: [], sendMessage: vi.fn() }),
}));

// ✅ Good - includes all imports
vi.mock("@ai-sdk/react", () => ({
  useChat: () => ({ messages: [], sendMessage: vi.fn() }),
  DefaultChatTransport: vi.fn(),
}));
```

## Test Coverage for Toggle Components

**Test both directions** of toggle functionality (open and close) for components with dual-purpose buttons.

```tsx
// ✅ Good - tests both open and close via toggle button
it("opens widget when toggle clicked", async () => { /* ... */ });
it("closes widget when toggle clicked while open", async () => { /* ... */ });
```
